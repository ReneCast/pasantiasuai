<div class="container-fluid m-2">
	<div class="row">

		<div class="col-12">
			<div id="pasos"></div>
		</div>

		<div class="col-md-6">
			<div id="validacionSupervisor"></div>
		</div>
		<div class="col-md-6">
			<div id="inscripcionesTerminadas"></div>
		</div>

	</div>
</div>

<!-- Modal Paso 1 -->
<div class="modal fade" id="Modal_pasantiaPaso1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_pasantiaPaso1">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Paso 2 -->
<div class="modal fade" id="Modal_pasantiaPaso2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_pasantiaPaso2">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Paso 3 -->
<div class="modal fade" id="Modal_pasantiaPaso3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_pasantiaPaso3">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Paso 4 -->
<div class="modal fade" id="Modal_pasantiaPaso4" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_pasantiaPaso4">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Pasantias Validadas Supervisor--->
<div class="modal fade" id="Modal_PasantiasValidadasSupervisor" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_PasantiasValidadasSupervisor">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Pasantias No Validadas Supervisor--->
<div class="modal fade" id="Modal_NoPasantiasValidadasSupervisor" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_NoPasantiasValidadasSupervisor">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Inscripciones Terminadas-->
<div class="modal fade" id="Modal_inscripcionesTerminadas" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_inscripcionesTerminadas">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Inscripciones No Terminadas--->
<div class="modal fade" id="Modal_inscripcionesNoTerminadas" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="bodyModal_inscripcionesNoTerminadas">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<script>
//Estadisticas Paso 1
tabla_detalleAlumnos(@json($estadisticasPasantias['alumnosPasantiaPaso1']), 'g_pasantiaPaso1', 'bodyModal_pasantiaPaso1');
//Estadisticas Paso 2
tabla_detalleAlumnos(@json($estadisticasPasantias['alumnosPasantiaPaso2']), 'g_pasantiaPaso2', 'bodyModal_pasantiaPaso2');
//Estadisticas Paso 3
tabla_detalleAlumnos(@json($estadisticasPasantias['alumnosPasantiaPaso3']), 'g_pasantiaPaso3', 'bodyModal_pasantiaPaso3');
//Estadisticas Paso 4
tabla_detalleAlumnos(@json($estadisticasPasantias['alumnosPasantiaPaso4']), 'g_pasantiaPaso4', 'bodyModal_pasantiaPaso4');


//Validadas Supervisor
tabla_detalleAlumnos(@json($estadisticasSupervisores['alumnosPasantiasValidadasSupervisor']), 'g_PasantiasValidadasSupervisor', 'bodyModal_PasantiasValidadasSupervisor');
//NO Validadas Supervisor
tabla_detalleAlumnos(@json($estadisticasSupervisores['alumnosNoPasantiasValidadasSupervisor']), 'g_NoPasantiasValidadasSupervisor', 'bodyModal_NoPasantiasValidadasSupervisor');


//Inscripciones Terminadas
tabla_detalleAlumnos(@json($estadisticasInscripciones['alumnosInscripcionesTerminadas']), 'g_inscripcionesTerminadas', 'bodyModal_inscripcionesTerminadas');
//Inscripciones NO terminadas
tabla_detalleAlumnos(@json($estadisticasInscripciones['alumnosInscripcionesNoTerminadas']), 'g_inscripcionesNoTerminadas', 'bodyModal_inscripcionesNoTerminadas');

//Grafico pasos de cada alumno
window.chart = new Highcharts.chart({
	chart: {
		//forma
		type: 'bar',
		//ubicacion
		renderTo: 'pasos',
		//tamaño
		height: (9 / 16 * 75) + '%'
	},
	title: {
		//texto titulo
		text: 'Porcentaje de postulantes en cada paso ',
		//estilos del titulo
		style: {
			fontSize: '22px'
		}
	},
	//Habilitar botones de descarga
	exporting: {
		enabled: true,
		csv: {
			dateFormat:'%A, %b %e, %Y'
		}
	},
	//Eliminar creditos del grafico
	credits: {
		enabled: false
	},
	//Todo sobre el eje X
	xAxis: {
		type: 'category',
		labels: {
			style: {
				fontSize: '1.25em',
				fontWeight: 'bold'
			}
		}
	},
	//Todo sobre el eje Y
	yAxis: {
		title: {
      text: 'Porcentaje de postulantes',
			style: {
				fontSize: '1.25em',
				fontWeight: 'bold'
			}
		},
		labels: {
			style: {
				fontSize: '1em'
			}
		}
	},
	//Columnas del grafico
	plotOptions: {
		series: {
			colorByPoint: true,
			cursor: 'pointer',
			dataLabels: {
				enabled: true,
				inside: true,
			},
			point: {
				events: {
					//Que hacer al clickear una barra
					click: function (e) {
						$('#'+this.modal_ID).modal('toggle');
					}
				}
			}
		}
	},
	//Datos del grafico
	series: [{
		name: 'Postulantes',
		dataLabels: [{
			//Lo que se debe ver en el grafico
			align: 'right',
			format: '{y} '
		},{
			align: 'center',
			format: '{point.porcentajePostulantes:.2f} %'
		}],
		//Datos
		data: [{
			y: @json($estadisticasPasantias['pasantiasPaso1Count']),
			porcentajePostulantes: @json($estadisticasPasantias['pasantiasPaso1Count']) / @json($estadisticasPasantias['pasantiasTotal']) * 100,
			name: 'Requisitos académicos',
			modal_ID: 'Modal_pasantiaPaso1'
		}, {
			y: @json($estadisticasPasantias['pasantiasPaso2Count']),
			porcentajePostulantes: @json($estadisticasPasantias['pasantiasPaso2Count']) / @json($estadisticasPasantias['pasantiasTotal']) * 100,
			name: 'Inscripción pasantía',
			modal_ID: 'Modal_pasantiaPaso2'
		}, {
			y: @json($estadisticasPasantias['pasantiasPaso3Count']),
			porcentajePostulantes: @json($estadisticasPasantias['pasantiasPaso3Count']) / @json($estadisticasPasantias['pasantiasTotal']) * 100,
			name: 'Inscripción supervisor',
			modal_ID: 'Modal_pasantiaPaso3'
		}, {
			y: @json($estadisticasPasantias['pasantiasPaso4Count']),
			porcentajePostulantes: @json($estadisticasPasantias['pasantiasPaso4Count']) / @json($estadisticasPasantias['pasantiasTotal']) * 100,
			name: 'Inscripción proyecto',
			modal_ID: 'Modal_pasantiaPaso4'
		}],
		showInLegend: false
	}]
});

//Pie chart de validaciones de supervisor
pieChartConstructor('validacionSupervisor', 'Pasantías validadas por supervisor', 'Pasantía',
	//data_Attributes1
	['Pasantías no validadas por supervisor',
	@json($estadisticasSupervisores['pasantiasNoValidadasSupervisorCount']),
	@json($estadisticasSupervisores['pasantiasNoValidadasSupervisorPorcentaje']),
	'Modal_NoPasantiasValidadasSupervisor'],
	//data_Attributes2
	['Pasantías validadas por supervisor',
	@json($estadisticasSupervisores['pasantiasValidadasSupervisorCount']),
	@json($estadisticasSupervisores['pasantiasValidadasSupervisorPorcentaje']),
	'Modal_PasantiasValidadasSupervisor']);
	//Pie chart de inscripciones terminadas
pieChartConstructor('inscripcionesTerminadas', 'Estado de las pasantías', 'Pasantías',
	//data_Attributes1
	['Pasantías terminadas',
	@json($estadisticasInscripciones['inscripcionesTerminadasCount']),
	@json($estadisticasInscripciones['inscripcionesTerminadasPorcentaje']),
	'Modal_inscripcionesTerminadas'],
	//data_Attributes2
	['Pasantías no terminadas',
	@json($estadisticasInscripciones['inscripcionesNoTerminadasCount']),
	@json($estadisticasInscripciones['inscripcionesNoTerminadasPorcentaje']),
	'Modal_inscripcionesNoTerminadas']);
</script>